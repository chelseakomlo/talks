% https://nymity.ch/tikz/

\documentclass[hyperref={pdfpagelabels=true},table,dvipsnames,14pt,aspectratio=169]{beamer}
\usetheme{Boadilla}
\setbeamertemplate{navigation symbols}{}

\usepackage{amsthm, amsfonts, amssymb, amsmath, graphicx}
\usepackage{amsmath}
\usepackage{amsfonts, txfonts}
\usepackage{wasysym}
\usepackage{xcolor}

\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tikzpeople}
\usepackage{pgfplots}
\pgfplotsset{compat=1.15}
\usetikzlibrary{arrows}

\pgfdeclareimage[height=5ex]{crysplogo}{crysplogo}
\pgfdeclareimage[height=5ex]{cscslogo}{cscslogo}
\pgfdeclareimage[height=5ex]{torlogo}{torlogo}
\pgfdeclareimage[height=1.5ex]{clikey}{key}
\pgfdeclareimage[height=1.5ex]{srvkey}{key-green}
\pgfdeclareimage[height=1.5ex]{clivrfkey}{key-blue}
\pgfdeclareimage[height=1.5ex]{srvvrfkey}{key-red}

\titlegraphic{
\raisebox{1ex}{
\pgfuseimage{crysplogo}~~~
\pgfuseimage{cscslogo}~~~
\pgfuseimage{torlogo}
}
}

\definecolor{AlertRed}{rgb}{1.0,0.125,0.25}
\setbeamercolor{alerted text}{fg=AlertRed}
%\setbeamerfont{alerted text}{shape=\bfseries,size=\huge}
\definecolor{auth}{RGB}{138,23,94}

\newcommand\shortdoc{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=gray] (0,0) -- (2,0) -- (2,-2) -- (-1,-2) -- (-1,-1) -- cycle; \end{tikzpicture}}
\newcommand\medconsensus{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=gray] (0,0) -- (2,0) -- (2,-6) -- (-1,-6) -- (-1,-1) -- cycle; \node[shape=star,star points=9,fill=auth,inner sep=0pt,star point ratio=.5,minimum size=2mm,anchor=south east] at (1.8,-5.8) {} ; \end{tikzpicture}}
\newcommand\longconsensus{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=gray] (0,0) -- (2,0) -- (2,-13) -- (-1,-13) -- (-1,-1) -- cycle; \node[shape=star,star points=9,fill=auth,inner sep=0pt,star point ratio=.5,minimum size=2mm,anchor=south east] at (1.8,-12.8) {} ; \end{tikzpicture}}
\newcommand\netdocunsigned{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=ProcessBlue] (0,0) -- (2,0) -- (2,-2) -- (-1,-2) -- (-1,-1) -- cycle; \end{tikzpicture}}
\newcommand\netdoc{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=ProcessBlue] (0,0) -- (2,0) -- (2,-2) -- (-1,-2) -- (-1,-1) -- cycle; \node[shape=star,star points=9,fill=auth,inner sep=0pt,star point ratio=.5,minimum size=2mm,anchor=south east] at (1.8,-1.8) {} ; \end{tikzpicture}}
\newcommand\snipdoc{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=LimeGreen] (0,0) -- (2,0) -- (2,-2) -- (-1,-2) -- (-1,-1) -- cycle; \node[shape=star,star points=9,fill=auth,inner sep=0pt,star point ratio=.5,minimum size=2mm,anchor=south east] at (1.8,-1.8) {} ; \end{tikzpicture}}
\newcommand\docendive{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=ForestGreen] (0,0) -- (2,0) -- (2,-11) -- (-1,-11) -- (-1,-1) -- cycle; \node[shape=star,star points=9,fill=auth,inner sep=0pt,star point ratio=.5,minimum size=2mm,anchor=south east] at (1.8,-10.8) {} ; \end{tikzpicture}}
\newcommand\snipdocunsigned{\begin{tikzpicture}[scale=.25] \draw[-,draw=black,fill=LimeGreen] (0,0) -- (2,0) -- (2,-2) -- (-1,-2) -- (-1,-1) -- cycle; \end{tikzpicture}}


\pgfdeclarelayer{background}
\pgfdeclarelayer{backbackground}
\pgfdeclarelayer{foreground}
\pgfsetlayers{backbackground,background,main,foreground}   %% some additional layers for demo

\usetikzlibrary{shapes,decorations.shapes}
\tikzset{>=latex}


\title[Walking Onions]{Walking Onions: Scaling Anonymity Networks while Protecting Users}
\author{\textbf{Chelsea H. Komlo}, Nick Mathewson, Ian Goldberg}
\institute{\small{Presented at USENIX Security}}
\date{13 August, 2020}

\begin{document}
\setbeamertemplate{itemize items}[triangle]

\begin{frame}
        \thispagestyle{empty}
        \maketitle
\end{frame}


\begin{frame}
\frametitle{Motivation}
  \begin{itemize}
    \item Design protocols that enable anonymity networks like Tor to scale
      significantly beyond their current sizes.
        \begin{itemize}
          \item Add relays to network to increase capacity
          \item While not increasing the overhead to clients to participate.
        \end{itemize}
    \item Do all of this in a way that does not change their existing security model
  \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Our Contributions}
  \begin{itemize}
    \item Walking Onions, a set of protocols that allows anonymity networks
      like Tor to scale with constant-size overhead to users.
    \item Walking Onions maintains the existing security model for Tor in one
      variant, with a slight loss of forward secrecy in the other variant.
    \item Demonstrates performance improvements at networks the size of Tor
      today.
  \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Outline}
  \begin{enumerate}
    \item Review of Current Tor and Performance Bottlenecks
    \item Requirements to maintain similar security
    \item Walking Onions
    \item Comparison to current Tor
      \begin{enumerate}
        \item Security
        \item Performance
      \end{enumerate}
  \end{enumerate}
\end{frame}

\begin{frame}
  \centering
  \huge
  Current Tor
\end{frame}

\begin{frame}
\frametitle{Current Tor Security Model}

Current Tor optimizes for security over scalability

  \begin{itemize}
    \item \textbf{Epistemic Attacks}
    \item \textbf{Route-Capture Attacks}
  \end{itemize}

\end{frame}

\begin{frame}
\frametitle{Current Tor Scalability}

Quadratic cost to client relative to number of relays.

\end{frame}

\begin{frame}
  \centering
  \huge
  Walking Onions
\end{frame}

\begin{frame}
\frametitle{New Data Structures: SNIPs and ENDIVEs}
  \begin{itemize}
    \item We need data structures such that each individual record can be
      individually verified
    \item We also need each record to be selectable via a single integer, so
      clients can make a selection without requiring the entire consensus
  \end{itemize}
\end{frame}

\begin{frame}
\frametitle{SNIP: Seperable Network Index Proof}
\centerline{%
\begin{tikzpicture}
\node at (-7,-3.5) {~};
\node at (7,3.5) {~};
\node [font=\large,text centered,text width=.2\textwidth] (constitle) at (-5,2) {Current\\Consensus};
\node [anchor=north,inner sep=0pt] (cons) at ($(constitle.south) + (0,-.2)$) {\longconsensus};
\node [anchor=north,inner sep=0pt] (netdoc) at ($(cons.north east)+(1.5,0)$) {\netdocunsigned};
\node [anchor=north,inner sep=0pt] (d1) at ($(netdoc.south)+(0,-.1)$) {\shortdoc};
\node [anchor=north,inner sep=0pt] (d2) at (d1.south) {\shortdoc};
\node [anchor=north,inner sep=0pt] (d3) at (d2.south) {\shortdoc};
\node [anchor=south,inner sep=0pt] (d4) at ($(cons.south west)!(d2.south)!(cons.south east)$) {\shortdoc};
\node [anchor=north,inner sep=0pt] at ($(d3.south)+(0,.1)$) {$\mathbf{\vdots}$};
\draw [line width=2pt,double,thick,double equal sign distance,-implies] ($($(netdoc.north west)!(cons.east)!(netdoc.south west)$)!.1!(cons.east)$) -- ($($(netdoc.north west)!(cons.east)!(netdoc.south west)$)!.9!(cons.east)$);
\node<2> [anchor=north west,inner sep=0pt] (snip) at (-1,3) {\scalebox{10}{\snipdocunsigned}};
\node<2> [anchor=north,inner sep=0pt] (snipdesc) at ($(snip.north)+(0,-.2)$) {\scalebox{8}{\shortdoc}};
\node<2> [anchor=south west,font=\large] at ($(snip.south west)!(snipdesc.south west)!(snip.south east)$) {[5284,5716)};
\node<2> [shape=star,star points=9,fill=auth,inner sep=0pt,star point ratio=.5,minimum size=4mm,anchor=south east] at ($(snip.south east)+(-.3,.3)$) {} ;
\node<3-> [font=\large,anchor=south] (sniptitle) at ($(constitle.south west)!(2.5,3)!(constitle.south east)$) {SNIPs};
\node<3-> [anchor=north,inner sep=0pt] (snip1) at ($(sniptitle.north)!(d1.north)!(sniptitle.south)$) {\snipdoc};
\node<3-> [anchor=north,inner sep=0pt] (snip2) at ($(sniptitle.north)!(d2.north)!(sniptitle.south)$) {\snipdoc};
\node<3-> [anchor=north,inner sep=0pt] (snip3) at ($(sniptitle.north)!(d3.north)!(sniptitle.south)$) {\snipdoc};
\node<3-> [anchor=north,inner sep=0pt] at ($(snip3.south)+(0,.1)$) {$\mathbf{\vdots}$};
\node<3-> [anchor=north,inner sep=0pt] (snip4) at ($(sniptitle.north)!(d4.north)!(sniptitle.south)$) {\snipdoc};
\draw<3-> [line width=2pt,double,thick,double equal sign distance,-implies] ($(d1.east)!.3cm!(snip1.west)$) -- ($(d1.east)!.95!(snip1.west)$);
\draw<4-> [line width=2pt,double,thick,double equal sign distance,-implies] ($(d2.east)!.3cm!(snip2.west)$) -- ($(d2.east)!.95!(snip2.west)$);
\draw<4-> [line width=2pt,double,thick,double equal sign distance,-implies] ($(d3.east)!.3cm!(snip3.west)$) -- ($(d3.east)!.95!(snip3.west)$);
\draw<4-> [line width=2pt,double,thick,double equal sign distance,-implies] ($(d4.east)!.3cm!(snip4.west)$) -- ($(d4.east)!.95!(snip4.west)$);
\end{tikzpicture}
}
\end{frame}

\begin{frame}
\frametitle{ENDIVE: Efficient Network Directory with Independently Verifiable
  Entries }
\centerline{%
\begin{tikzpicture}
\node at (-7,-3.5) {~};
\node at (7,3.5) {~};
\node [font=\large,text centered,text width=.2\textwidth] (constitle) at (-5,2) {Current\\Consensus};
\node [anchor=north,inner sep=0pt] (cons) at ($(constitle.south) + (0,-.2)$) {\longconsensus};
\node [anchor=north,inner sep=0pt] (netdoc) at ($(cons.north east)+(1.5,0)$) {\netdocunsigned};
\node [anchor=north,inner sep=0pt] (d1) at ($(netdoc.south)+(0,-.1)$) {\shortdoc};
\node [anchor=north,inner sep=0pt] (d2) at (d1.south) {\shortdoc};
\node [anchor=north,inner sep=0pt] (d3) at (d2.south) {\shortdoc};
\node [anchor=south,inner sep=0pt] (d4) at ($(cons.south west)!(d2.south)!(cons.south east)$) {\shortdoc};
\node [anchor=north,inner sep=0pt] at ($(d3.south)+(0,.1)$) {$\mathbf{\vdots}$};
\draw [line width=2pt,double,thick,double equal sign distance,-implies] ($($(netdoc.north west)!(cons.east)!(netdoc.south west)$)!.1!(cons.east)$) -- ($($(netdoc.north west)!(cons.east)!(netdoc.south west)$)!.9!(cons.east)$);
\node [font=\large,anchor=south] (sniptitle) at ($(constitle.south west)!(2.5,3)!(constitle.south east)$) {SNIPs};
\node [anchor=north,inner sep=0pt] (snip1) at ($(sniptitle.north)!(d1.north)!(sniptitle.south)$) {\snipdoc};
\node [anchor=north,inner sep=0pt] (snip2) at ($(sniptitle.north)!(d2.north)!(sniptitle.south)$) {\snipdoc};
\node [anchor=north,inner sep=0pt] (snip3) at ($(sniptitle.north)!(d3.north)!(sniptitle.south)$) {\snipdoc};
\node [anchor=north,inner sep=0pt] at ($(snip3.south)+(0,.1)$) {$\mathbf{\vdots}$};
\node [anchor=north,inner sep=0pt] (snip4) at ($(sniptitle.north)!(d4.north)!(sniptitle.south)$) {\snipdoc};
\draw [line width=2pt,double,thick,double equal sign distance,-implies] ($(d1.east)!.3cm!(snip1.west)$) -- ($(d1.east)!.95!(snip1.west)$);
\draw [line width=2pt,double,thick,double equal sign distance,-implies] ($(d2.east)!.3cm!(snip2.west)$) -- ($(d2.east)!.95!(snip2.west)$);
\draw [line width=2pt,double,thick,double equal sign distance,-implies] ($(d3.east)!.3cm!(snip3.west)$) -- ($(d3.east)!.95!(snip3.west)$);
\draw [line width=2pt,double,thick,double equal sign distance,-implies] ($(d4.east)!.3cm!(snip4.west)$) -- ($(d4.east)!.95!(snip4.west)$);
\node<1-> [font=\large,anchor=south] (endivetitle) at ($(constitle.south west)!(5,3)!(constitle.south east)$) {ENDIVE};
\node<1-> [anchor=north,inner sep=0pt] (endive) at ($(endivetitle.north)!(snip1.north)!(endivetitle.south)$) {\docendive};
\draw<1-> [line width=2pt,double,thick,double equal sign distance,-implies] ($($(snip1.north east)!(endive.west)!(snip1.south east)$)!.1!(endive.west)$) -- ($($(snip1.north east)!(endive.west)!(snip1.south east)$)!.9!(endive.west)$);
\node<2-> [font=\large,text centered,text width=.2\textwidth,anchor=south] (newconstitle) at ($(constitle.south west)!(0,3)!(constitle.south east)$) {New\\Consensus};
\node<2-> [anchor=north,inner sep=0pt] (newnetdoc) at ($(netdoc.north west)!(newconstitle.south)!(netdoc.north east)$) {\netdoc};
\draw<2-> [line width=2pt,double,thick,double equal sign distance,-implies] ($(netdoc.east)!.3cm!(newnetdoc.west)$) -- ($(netdoc.east)!.9!(newnetdoc.west)$);
\end{tikzpicture}
}
\end{frame}

\begin{frame}
\frametitle{Vanilla Walking Onions}
\begin{tikzpicture}
  \node[person,shirt=black,female,minimum size=1.1cm] (user1) at (3,-1) {};

  \begin{pgfonlayer}{background}

    \node[circle,draw,minimum size=1.5cm] (R1) at (7, -1) {$R_1$};
    \node[circle,draw,minimum size=1.5cm] (R2) at (10.5, 1) {$R_2$};
    \node[circle,draw,minimum size=1.5cm] (R3) at (14, -.5) {$R_3$};
    \node[circle,draw,minimum size=1.5cm] (R4) at (7.5, 3) {$R_4$};
    \node[circle,draw,minimum size=1.5cm] (R5) at (10, -1.5) {$R_5$};
    \node[circle,draw,minimum size=1.5cm] (R6) at (13, 2.5) {$R_6$};

  \end{pgfonlayer}
    \draw<1>[line width=1pt,->] (user1.east) -- (R1.west) node [below, midway]
    {Create $\pgfuseimage{clikey}_1$};

    \draw<2->[draw=green, line width=3pt,-] (user1.east) -- (R1.west) node
    [below, midway] {};
    \draw<2>[line width=1pt,->] (R1.west) -- (user1.east) node [below, midway]
    {$\pgfuseimage{srvkey}_1$};

    \draw<3>[line width=1pt,->] (user1.east) -- (R1.west) node [below, midway]
    {5 $\pgfuseimage{clikey}_1$};

    \draw<4>[line width=1pt,->] (R1.east) -- (R5.west) node [below, midway]
    {$\pgfuseimage{clikey}_1$};


    \draw<5->[draw=green, line width=3pt,-] (R1.east) -- (R5.west) node {};
    \draw<5>[line width=1pt,->] (R5.west) -- (R1.east) node [below, midway]
    {$\pgfuseimage{srvkey}_1$};

    \draw<6>[line width=1pt,->] (R1.west) -- (user1.east) node [below, midway]
    {$\pgfuseimage{srvkey}_5$, $\snipdoc_{R_5}$};

    \draw<7>[line width=1pt,->] (user1.east) -- (R1.west) node [below, midway]
    {3 $\pgfuseimage{clikey}_1$};

    \draw<8>[line width=1pt,->] (R1.east) -- (R5.west) node [below, midway]
    {3 $\pgfuseimage{clikey}_1$};

    \draw<9>[line width=1pt,->] (R5.east) -- (R3.west) node [below, midway]
    {$\pgfuseimage{clikey}_1$};

    \draw<10->[draw=green, line width=3pt,-] (R5.east) -- (R3.west) node {};
    \draw<10>[line width=1pt,->] (R3.west) -- (R5.east) node [below, midway]
    {$\pgfuseimage{srvkey}_3$};

    \draw<11>[line width=1pt,->] (R5.west) -- (R1.east) node [below, midway]
    {$\pgfuseimage{srvkey}_3$, $\snipdoc_{R_3}$};

    \draw<12>[line width=1pt,->] (R1.west) -- (user1.east) node [below, midway]
    {$\pgfuseimage{srvkey}_3$, $\snipdoc_{R_3}$};

\end{tikzpicture}
\end{frame}

\begin{frame}
\frametitle{Telescoping Walking Onions}

\end{frame}

\begin{frame}
\frametitle{Why do these maintain Tor's existing security level?}
\end{frame}

\begin{frame}
\frametitle{}

\begin{table}[t]
\renewcommand{\arraystretch}{1.2}
\caption{Comparison: Telescoping, Single-Pass, Current Tor }

\centering
\footnotesize

\CIRCLE=achieved; \Circle=not achieved;
  \LEFTcircle=partially achieved

$\Diamond$=performance property;
  $\dagger$=security property

    \begin{tabular}{|c|c|c|c|c|}
  \hline
  & & Telescop. & Single-Pass & Current Tor \\
  \hline
  $\Diamond$ & Constant-size client download & \CIRCLE & \CIRCLE & \Circle \\
  \hline
  $\Diamond$ & One round trip per circuit built & \Circle & \CIRCLE & \Circle \\
  % Start security properties
  \hline
  $\dagger$ & \raggedright Complete client control of relays selected & \LEFTcircle & \Circle & \CIRCLE \\
  \hline
  $\dagger$ & Forward-secret relay selection& \CIRCLE & \LEFTcircle & \CIRCLE \\
  \hline
  $\dagger$ & Forward secrecy for data & \CIRCLE & \CIRCLE & \CIRCLE \\
  \hline
  $\dagger$ & \raggedright Relays unaware of their positions in paths & \LEFTcircle & \Circle & \LEFTcircle \\
  \hline
\end{tabular}

\end{table}
\end{frame}


\begin{frame}
  \centering
  \huge
  Performance Evaluation
\end{frame}

\begin{frame}
\frametitle{Simulation}
Simulation description
\end{frame}

\begin{frame}
\frametitle{Bandwidth}
\end{frame}

\begin{frame}
\frametitle{CPU}
\end{frame}

\begin{frame}
\frametitle{Summary}
\end{frame}
\end{document}
